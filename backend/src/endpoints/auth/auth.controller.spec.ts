import { Test, TestingModule } from '@nestjs/testing';
import { AuthController } from './auth.controller';
import { AuthService } from './auth.service';
import { Request } from 'express';
describe('TemplatesController', () => {
  let controller: AuthController;

  const mockProvider = {
    getSession: jest.fn((mockToken) => {
      return mockToken;
    })
  }

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      controllers: [AuthController],
      providers: [AuthService],
    }).overrideProvider(AuthService).useValue(mockProvider).compile();

    controller = module.get<AuthController>(AuthController);
  });

  it('should be defined', () => {
    expect(controller).toBeDefined();
  });
  
  it('should fetch tokens', async () => {
    const mockToken = {
      "accessToken": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJoR3picUdnYnU3cHdxRXZYSHBYM19JTlFFVlpCMTBTVjh0SHNfSTJFSWJnIn0.eyJleHAiOjE3MzU5MDA4MzEsImlhdCI6MTcwNDM2NDgzMSwianRpIjoiMGQwOTkxZDMtMDgzZi00MDE3LThkZTktNzU3YmQ3ZDAwNjE0IiwiaXNzIjoiaHR0cHM6Ly9kZXZlbG9wbWVudC5pbmR1c3RyeS1mdXNpb24uY29tL2F1dGgvcmVhbG1zL2lmZiIsImF1ZCI6WyJvaXNwLWZyb250ZW5kIiwiZnVzaW9uLWJhY2tlbmQiLCJhY2NvdW50Il0sInN1YiI6IjMzMTE0OGNkLTM1MGUtNGIzZi04ZmZkLTRmMjQ1ZDBhY2I3MSIsInR5cCI6IkJlYXJlciIsImF6cCI6InNjb3JwaW8iLCJzZXNzaW9uX3N0YXRlIjoiODQxNzQ1OWMtNTBlOC00MTU3LWEwNGItYjgwZWIzYzdkNDEzIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtaWZmIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImZ1c2lvbi1iYWNrZW5kIjp7InJvbGVzIjpbIkZBQ1RPUllfTUFOQUdFUiIsIkZMRUVUX01BTkFHRVIiLCJFQ09TWVNURU1fTUFOQUdFUiJdfSwib2lzcC1mcm9udGVuZCI6eyJyb2xlcyI6WyJ1c2VyIl19LCJzY29ycGlvIjp7InJvbGVzIjpbIkZhY3RvcnktQWRtaW4iLCJGYWN0b3J5LVdyaXRlciIsIkZhY3RvcnktUmVhZGVyIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9pc3AtZnJvbnRlbmQgYWNjb3VudHMgZW1haWwgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyB0eXBlIiwic2lkIjoiODQxNzQ1OWMtNTBlOC00MTU3LWEwNGItYjgwZWIzYzdkNDEzIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInByZWZlcnJlZF91c2VybmFtZSI6ImZhY3RvcnlfYWRtaW4iLCJhY2NvdW50cyI6W3siaWQiOiJjNDcxMmMxNC1lZWVlLTQ4ODEtODU2ZS1jNWZiNTE1MzJjOTQiLCJyb2xlIjoiYWRtaW4ifV0sImdpdmVuX25hbWUiOiIiLCJ0eXBlIjoidXNlciIsImZhbWlseV9uYW1lIjoiIiwiZW1haWwiOiJmYWN0b3J5X2FkbWluQGluZHVzdHJ5LWZ1c2lvbi5jb20ifQ.tQ7xmGc33JsiiMaxpKxq8G5MSyxPAfOM_ZPDMLpfBEotgNWtmbgcbrrPG9H5u3gm70nHgHqauCA10MfKvW19aGzsCXhRWT0UcW1qpXb8KqNbvSaNwBdVXEN3nIidIJ0sfdXSpjq0S-oZ-gR6_1ZootNV_BSSBnbTZJuBb-q5dZmjHuQgHQY6UTs35yLsgwY_BFicWKwll7FIMV4pcSvAoB92_iT6Asty83reVxQnH60YmIw69fBV_6qgO7tstfMBtdGFdKd-iDYAnIPn2V3ic-u6HQbQboPeKgszPJXb5Y46dp5ulYcgcNfJdLeK7N24-tQEmgFVtOJdoVQDRr3XfA",
      "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwMmRkNjQxMy1lN2QyLTQ3ODItYWNjMy04ZGRkYTY2MTBlNjUifQ.eyJpYXQiOjE3MDQzNjQ4MzEsImp0aSI6IjJkM2RmMWE4LTk1OTMtNDRjYS1hOTE0LWViNTk2MGQwNGExMyIsImlzcyI6Imh0dHBzOi8vZGV2ZWxvcG1lbnQuaW5kdXN0cnktZnVzaW9uLmNvbS9hdXRoL3JlYWxtcy9pZmYiLCJhdWQiOiJodHRwczovL2RldmVsb3BtZW50LmluZHVzdHJ5LWZ1c2lvbi5jb20vYXV0aC9yZWFsbXMvaWZmIiwic3ViIjoiMzMxMTQ4Y2QtMzUwZS00YjNmLThmZmQtNGYyNDVkMGFjYjcxIiwidHlwIjoiT2ZmbGluZSIsImF6cCI6InNjb3JwaW8iLCJzZXNzaW9uX3N0YXRlIjoiODQxNzQ1OWMtNTBlOC00MTU3LWEwNGItYjgwZWIzYzdkNDEzIiwic2NvcGUiOiJvaXNwLWZyb250ZW5kIGFjY291bnRzIGVtYWlsIHByb2ZpbGUgb2ZmbGluZV9hY2Nlc3MgdHlwZSIsInNpZCI6Ijg0MTc0NTljLTUwZTgtNDE1Ny1hMDRiLWI4MGViM2M3ZDQxMyJ9.OuGH5dBLLKFtwdBJWSUe_UnstvLI2pk2NUlxJHcobvA",
      "id": "xKKBzLrSzM0SQ6g0aKuQpHCkTZ_WnUtE"
    }
    const result = await controller.getSession(mockToken);
    expect(result).toEqual({
      access_token: "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJoR3picUdnYnU3cHdxRXZYSHBYM19JTlFFVlpCMTBTVjh0SHNfSTJFSWJnIn0.eyJleHAiOjE3MzU5MDA4MzEsImlhdCI6MTcwNDM2NDgzMSwianRpIjoiMGQwOTkxZDMtMDgzZi00MDE3LThkZTktNzU3YmQ3ZDAwNjE0IiwiaXNzIjoiaHR0cHM6Ly9kZXZlbG9wbWVudC5pbmR1c3RyeS1mdXNpb24uY29tL2F1dGgvcmVhbG1zL2lmZiIsImF1ZCI6WyJvaXNwLWZyb250ZW5kIiwiZnVzaW9uLWJhY2tlbmQiLCJhY2NvdW50Il0sInN1YiI6IjMzMTE0OGNkLTM1MGUtNGIzZi04ZmZkLTRmMjQ1ZDBhY2I3MSIsInR5cCI6IkJlYXJlciIsImF6cCI6InNjb3JwaW8iLCJzZXNzaW9uX3N0YXRlIjoiODQxNzQ1OWMtNTBlOC00MTU3LWEwNGItYjgwZWIzYzdkNDEzIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtaWZmIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImZ1c2lvbi1iYWNrZW5kIjp7InJvbGVzIjpbIkZBQ1RPUllfTUFOQUdFUiIsIkZMRUVUX01BTkFHRVIiLCJFQ09TWVNURU1fTUFOQUdFUiJdfSwib2lzcC1mcm9udGVuZCI6eyJyb2xlcyI6WyJ1c2VyIl19LCJzY29ycGlvIjp7InJvbGVzIjpbIkZhY3RvcnktQWRtaW4iLCJGYWN0b3J5LVdyaXRlciIsIkZhY3RvcnktUmVhZGVyIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9pc3AtZnJvbnRlbmQgYWNjb3VudHMgZW1haWwgcHJvZmlsZSBvZmZsaW5lX2FjY2VzcyB0eXBlIiwic2lkIjoiODQxNzQ1OWMtNTBlOC00MTU3LWEwNGItYjgwZWIzYzdkNDEzIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsInByZWZlcnJlZF91c2VybmFtZSI6ImZhY3RvcnlfYWRtaW4iLCJhY2NvdW50cyI6W3siaWQiOiJjNDcxMmMxNC1lZWVlLTQ4ODEtODU2ZS1jNWZiNTE1MzJjOTQiLCJyb2xlIjoiYWRtaW4ifV0sImdpdmVuX25hbWUiOiIiLCJ0eXBlIjoidXNlciIsImZhbWlseV9uYW1lIjoiIiwiZW1haWwiOiJmYWN0b3J5X2FkbWluQGluZHVzdHJ5LWZ1c2lvbi5jb20ifQ.tQ7xmGc33JsiiMaxpKxq8G5MSyxPAfOM_ZPDMLpfBEotgNWtmbgcbrrPG9H5u3gm70nHgHqauCA10MfKvW19aGzsCXhRWT0UcW1qpXb8KqNbvSaNwBdVXEN3nIidIJ0sfdXSpjq0S-oZ-gR6_1ZootNV_BSSBnbTZJuBb-q5dZmjHuQgHQY6UTs35yLsgwY_BFicWKwll7FIMV4pcSvAoB92_iT6Asty83reVxQnH60YmIw69fBV_6qgO7tstfMBtdGFdKd-iDYAnIPn2V3ic-u6HQbQboPeKgszPJXb5Y46dp5ulYcgcNfJdLeK7N24-tQEmgFVtOJdoVQDRr3XfA",
      refresh_token: "eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIwMmRkNjQxMy1lN2QyLTQ3ODItYWNjMy04ZGRkYTY2MTBlNjUifQ.eyJpYXQiOjE3MDQzNjQ4MzEsImp0aSI6IjJkM2RmMWE4LTk1OTMtNDRjYS1hOTE0LWViNTk2MGQwNGExMyIsImlzcyI6Imh0dHBzOi8vZGV2ZWxvcG1lbnQuaW5kdXN0cnktZnVzaW9uLmNvbS9hdXRoL3JlYWxtcy9pZmYiLCJhdWQiOiJodHRwczovL2RldmVsb3BtZW50LmluZHVzdHJ5LWZ1c2lvbi5jb20vYXV0aC9yZWFsbXMvaWZmIiwic3ViIjoiMzMxMTQ4Y2QtMzUwZS00YjNmLThmZmQtNGYyNDVkMGFjYjcxIiwidHlwIjoiT2ZmbGluZSIsImF6cCI6InNjb3JwaW8iLCJzZXNzaW9uX3N0YXRlIjoiODQxNzQ1OWMtNTBlOC00MTU3LWEwNGItYjgwZWIzYzdkNDEzIiwic2NvcGUiOiJvaXNwLWZyb250ZW5kIGFjY291bnRzIGVtYWlsIHByb2ZpbGUgb2ZmbGluZV9hY2Nlc3MgdHlwZSIsInNpZCI6Ijg0MTc0NTljLTUwZTgtNDE1Ny1hMDRiLWI4MGViM2M3ZDQxMyJ9.OuGH5dBLLKFtwdBJWSUe_UnstvLI2pk2NUlxJHcobvA",
      sessionId: "xKKBzLrSzM0SQ6g0aKuQpHCkTZ_WnUtE"
    })
  })

});
